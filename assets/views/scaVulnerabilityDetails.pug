html
  head
    -
      var cspContent = `
        default-src 'none';
        img-src ${cspSource} https:;
        style-src 'unsafe-inline' https://cdn.jsdelivr.net ${cspSource} https://cdnjs.cloudflare.com;
        script-src 'unsafe-inline' https://cdn.jsdelivr.net ${cspSource};
        font-src *;
      `;
    meta(http-equiv="Content-Security-Policy",  content=cspContent)
    link(rel="stylesheet", href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css", media="screen and (prefers-color-scheme: dark)")
    link(rel="stylesheet", type="text/css", href="https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css")
    link(rel="stylesheet", type="text/css", href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css")
    link(rel="stylesheet", type="text/css", href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css")
    link(href!=styleURI, rel="stylesheet")
    script(src="https://cdn.jsdelivr.net/npm/marked/marked.min.js")

  body

    h3.d-flex.align-items-center
      img(src!=logoURI, alt="Logo", width="50")
      span.text-white.mx-3 !{vulnerability.package.name} - !{vulnerability.package.version}
    strong
      span.mr-2(class=`${vulnerability.severity} UNSPECIFIED severity`) !{vulnerability.severity}
    span.UNSPECIFIED.severity !{vulnerabilityGroup.ecosystem}
    .d-inline-flex.align-items-center.mt-2.mx-4
      span.badge.rounded-pill.bg-danger.mx-1(title="Current version") !{vulnerability.package.version}
      i.fa-solid.fa-arrow-right-long.mx-2.text-white
      if !vulnerabilityGroup.fixes_all
        span.badge.rounded-pill.bg-warning.mx-1(title="No fix version available") No Fix Available
      else
        span.badge.rounded-pill.bg-success.mx-1(title=`Fixed in version ${vulnerabilityGroup.fixes_all}`)
          if vulnerability.package.version > vulnerabilityGroup.fixes_all
            i.fa-solid.fa-caret-down.me-1
          else
            i.fa-solid.fa-caret-up.me-1
          | !{vulnerabilityGroup.fixes_all}
    hr
    a(href=`command:vscode.open?${corgeaURI}`).mb-2
      button.btn-secondary.mr-2 See on Corgea

    .card.mb-4
      .card-header Vulnerability in !{vulnerability.package.name}@!{vulnerability.package.version} Fixed in !{vulnerability.package.fix_version}
      .card-body
        h6.text-white Vulnerability Explanation
        div.issue_explanation.markdown-body.text-white.d-none !{vulnerability.details}
    script.
      const contents = document.querySelectorAll('.markdown-body');
      contents.forEach(content => {
        content.innerHTML = marked.parse(content.innerHTML);
        content.classList.remove('d-none');
      });
