if hasVulnerabilities
  .accordion(id="codeAccordion")
    each fileGroup in fileGroups
      .accordion-item
        h2.accordion-header(id=`code-heading-${fileGroup.index}`)
          button.accordion-button.collapsed(type="button", data-bs-toggle="collapse", data-bs-target=`#code-collapse-${fileGroup.index}`, aria-expanded="false", aria-controls=`code-collapse-${fileGroup.index}`)
            .file-path
              i.fas.fa-file-code.file-icon
              span= fileGroup.path
              span.count-badge= fileGroup.vulnerabilities.length
        div.accordion-collapse.collapse(id=`code-collapse-${fileGroup.index}`, aria-labelledby=`code-heading-${fileGroup.index}`, data-bs-parent="#codeAccordion")
          .accordion-body
            each vuln, vulnIndex in fileGroup.vulnerabilities
              .vulnerability-item(data-vuln-id=vuln.id, onclick=`showVulnerabilityDetails('${vuln.id}')`)
                .vuln-info
                  .vuln-name= vuln.classification ? vuln.classification.name : 'Unknown Vulnerability'
                  .vuln-details
                    span.line-number Line #{vuln.location.line_number}
                    span Status: #{vuln.status}
                .severity-badge(class=vuln.urgency, data-original-severity=vuln.urgency)= vuln.urgency
else
  .empty-state
    .empty-icon üìù
    div No code vulnerabilities found in this project
    p.text-muted.mt-2 Your code appears to be secure! Check the Dependencies tab for any potential supply chain vulnerabilities. 