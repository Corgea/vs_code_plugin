import React from 'react';
import { useVulnerabilities, SCAVulnerability } from '../../context/VulnerabilitiesContext';
import SeverityBadge from '../SeverityBadge/SeverityBadge';
import './SCAVulnerabilityItem.css';

interface SCAVulnerabilityItemProps {
  vulnerability: SCAVulnerability;
  isLast?: boolean;
}

const SCAVulnerabilityItem: React.FC<SCAVulnerabilityItemProps> = ({ vulnerability, isLast }) => {
  const { actions } = useVulnerabilities();

  const handleClick = () => {
    actions.showSCAVulnerabilityDetails(vulnerability);
  };

  return (
    <div 
      className={`sca-vulnerability-item ${isLast ? 'last' : ''}`}
      onClick={handleClick}
    >
      <div className="vuln-info">
        <div className="vuln-name">{vulnerability.cve}</div>
        <div className="vuln-details">
          <span>Fixed in version {vulnerability.package.fix_version}</span>
          <span>{vulnerability.package.ecosystem}</span>
        </div>
      </div>
      <SeverityBadge severity={vulnerability.severity} />
    </div>
  );
};

export default SCAVulnerabilityItem;
